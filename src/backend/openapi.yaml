openapi: 3.0.3
info:
  title: IT-Ticket API
  description: |
    A comprehensive IT ticket management system API that handles user authentication, 
    issue tracking, comments, notifications, audit logging and many more features.
    
    ## Authentication
    All endpoints (except authentication endpoints) require a valid JWT token in the Authorization header.
    
    ## Authorization Levels
    - **User**: Can access their own data and issues
    - **Support**: Can access all issues and user data
    - **Admin**: Full access to all endpoints and user management
  version: 1.0.0
  contact:
    name: IT-Ticket Development Team
    url: https://github.com/An0n-00/IT-Ticket
  license:
    name: Custom
    url: https://github.com/An0n-00/IT-Ticket/blob/main/LICENSE

servers:
  - url: http://localhost:3001
    description: Development server

security:
  - BearerAuth: []

paths:
  # Authentication Endpoints
  /auth/api/login:
    post:
      tags:
        - Authentication
      summary: User login
      description: Authenticates a user and returns a JWT token
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginDTO'
            example:
              username: "john_doe"
              password: "securePassword123"
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        '400':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '403':
          description: Account suspended
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  /auth/api/register:
    post:
      tags:
        - Authentication
      summary: User registration
      description: Registers a new user and returns a JWT token
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterDTO'
            example:
              username: "jane_doe"
              password: "securePassword123"
              email: "jane@example.com"
              firstName: "Jane"
              lastName: "Doe"
      responses:
        '200':
          description: Registration successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        '400':
          description: Registration failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  # User Endpoints
  /api/user:
    get:
      tags:
        - Users
      summary: Get current user ID
      description: Returns the ID of the currently authenticated user
      responses:
        '200':
          description: Current user ID
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

  /api/user/{id}:
    get:
      tags:
        - Users
      summary: Get user by ID
      description: Returns user information. Users can only access their own data unless they have admin privileges
      parameters:
        - $ref: '#/components/parameters/UserIdPath'
      responses:
        '200':
          description: User information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserDTO'
        '400':
          description: Invalid user ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

    patch:
      tags:
        - Users
      summary: Update user
      description: Updates user information. Users can only update their own data unless they have admin privileges
      parameters:
        - $ref: '#/components/parameters/UserIdPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserDTO'
      responses:
        '200':
          description: User updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserDTO'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

    delete:
      tags:
        - Users
      summary: Delete user
      description: Soft deletes a user. Users can delete their own account, admins can delete any user
      parameters:
        - $ref: '#/components/parameters/UserIdPath'
      responses:
        '204':
          description: User deleted successfully
        '400':
          description: Invalid user ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  /api/user/all:
    get:
      tags:
        - Users
      summary: Get all users
      description: Returns all users in the system. Requires admin privileges
      responses:
        '200':
          description: List of all users
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserDTO'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  /api/user/{id}/elevate:
    post:
      tags:
        - Users
      summary: Elevate or demote user role
      description: Changes a user's role. Requires admin privileges
      parameters:
        - $ref: '#/components/parameters/UserIdPath'
        - name: roleId
          in: query
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the role to assign to the user
      responses:
        '200':
          description: User role updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserDTO'
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: User or role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  /api/user/{id}/suspend:
    post:
      tags:
        - Users
      summary: Suspend or unsuspend user
      description: Suspends or unsuspends a user account. Requires admin privileges
      parameters:
        - $ref: '#/components/parameters/UserIdPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SuspendUserDTO'
      responses:
        '200':
          description: User suspension status updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserDTO'
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  # Issue Endpoints
  /api/issue:
    get:
      tags:
        - Issues
      summary: Get user's issues
      description: Returns issue IDs. Admins and support see all issues, users see only their own
      responses:
        '200':
          description: List of issue IDs
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
                  format: uuid
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

    post:
      tags:
        - Issues
      summary: Create new issue
      description: Creates a new issue
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IssueDTO'
      responses:
        '200':
          description: Issue created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

  /api/issue/{id}:
    get:
      tags:
        - Issues
      summary: Get issue by ID
      description: Returns detailed issue information. Users can only access their own issues unless they have admin/support privileges
      parameters:
        - $ref: '#/components/parameters/IssueIdPath'
      responses:
        '200':
          description: Issue details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IssueToFrontendDTO'
        '400':
          description: Invalid issue ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Issue not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

    patch:
      tags:
        - Issues
      summary: Update issue
      description: Updates an existing issue. Users can update their own issues, admins/support can update any issue
      parameters:
        - $ref: '#/components/parameters/IssueIdPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IssueDTO'
      responses:
        '200':
          description: Issue updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IssueToFrontendDTO'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Issue not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

    delete:
      tags:
        - Issues
      summary: Delete issue
      description: Soft deletes an issue. Users can delete their own issues, admins/support can delete any issue
      parameters:
        - $ref: '#/components/parameters/IssueIdPath'
      responses:
        '204':
          description: Issue deleted successfully
        '400':
          description: Invalid issue ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Issue not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  /api/issue/all:
    get:
      tags:
        - Issues
      summary: Get all issues (Admin/Support only)
      description: Returns all issues in the system. Requires admin or support privileges
      responses:
        '200':
          description: List of all issues
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/IssueToFrontendDTO'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  # Comment Endpoints
  /api/comment:
    post:
      tags:
        - Comments
      summary: Create comment
      description: Creates a new comment on an issue or as a reply to another comment
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommentDTO'
      responses:
        '200':
          description: Comment created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommentResponseDTO'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Issue or parent comment not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  /api/comment/{id}:
    get:
      tags:
        - Comments
      summary: Get comment by ID
      description: Returns a specific comment
      parameters:
        - $ref: '#/components/parameters/CommentIdPath'
      responses:
        '200':
          description: Comment details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommentResponseDTO'
        '400':
          description: Invalid comment ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Comment not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

    patch:
      tags:
        - Comments
      summary: Update comment
      description: Updates a comment. Users can only update their own comments unless they have admin/support privileges
      parameters:
        - $ref: '#/components/parameters/CommentIdPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommentDTO'
      responses:
        '200':
          description: Comment updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommentResponseDTO'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Comment not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

    delete:
      tags:
        - Comments
      summary: Delete comment
      description: Soft deletes a comment. Users can only delete their own comments unless they have admin/support privileges
      parameters:
        - $ref: '#/components/parameters/CommentIdPath'
      responses:
        '204':
          description: Comment deleted successfully
        '400':
          description: Invalid comment ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Comment not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  # Notification Endpoints
  /api/notification:
    get:
      tags:
        - Notifications
      summary: Get user notifications
      description: Returns notification IDs for the current user
      responses:
        '200':
          description: List of notification IDs
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
                  format: uuid
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

  /api/notification/{id}:
    get:
      tags:
        - Notifications
      summary: Get notification by ID
      description: Returns a specific notification
      parameters:
        - $ref: '#/components/parameters/NotificationIdPath'
      responses:
        '200':
          description: Notification details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationResponseDTO'
        '400':
          description: Invalid notification ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Notification not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

    post:
      tags:
        - Notifications
      summary: Mark notification as read/unread
      description: Updates the read status of a notification
      parameters:
        - $ref: '#/components/parameters/NotificationIdPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NotificationDTO'
      responses:
        '200':
          description: Notification status updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationResponseDTO'
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Notification not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  # Tag Endpoints
  /api/tag:
    get:
      tags:
        - Tags
      summary: Get all tags
      description: Returns all available tag IDs
      responses:
        '200':
          description: List of tag IDs
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
                  format: uuid
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: No tags found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  /api/tag/{id}:
    get:
      tags:
        - Tags
      summary: Get tag by ID
      description: Returns a specific tag
      parameters:
        - $ref: '#/components/parameters/TagIdPath'
      responses:
        '200':
          description: Tag details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TagDTO'
        '400':
          description: Invalid tag ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Tag not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  # Status Endpoints
  /api/status:
    get:
      tags:
        - Status
      summary: Get all statuses
      description: Returns all available status IDs
      responses:
        '200':
          description: List of status IDs
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
                  format: uuid
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: No statuses found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  /api/status/{id}:
    get:
      tags:
        - Status
      summary: Get status by ID
      description: Returns a specific status
      parameters:
        - $ref: '#/components/parameters/StatusIdPath'
      responses:
        '200':
          description: Status details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusDTO'
        '400':
          description: Invalid status ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Status not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  # Priority Endpoints
  /api/priority:
    get:
      tags:
        - Priorities
      summary: Get all priorities
      description: Returns all available priority IDs
      responses:
        '200':
          description: List of priority IDs
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
                  format: uuid
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

  /api/priority/{id}:
    get:
      tags:
        - Priorities
      summary: Get priority by ID
      description: Returns a specific priority
      parameters:
        - $ref: '#/components/parameters/PriorityIdPath'
      responses:
        '200':
          description: Priority details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PriorityDTO'
        '400':
          description: Invalid priority ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Priority not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  # Role Endpoints
  /api/role:
    get:
      tags:
        - Roles
      summary: Get all roles
      description: Returns all available role IDs
      responses:
        '200':
          description: List of role IDs
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
                  format: uuid
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: No roles found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  /api/role/{id}:
    get:
      tags:
        - Roles
      summary: Get role by ID
      description: Returns a specific role
      parameters:
        - $ref: '#/components/parameters/RoleIdPath'
      responses:
        '200':
          description: Role details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RoleDTO'
        '400':
          description: Invalid role ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  # Audit Log Endpoints
  /api/auditlog:
    get:
      tags:
        - Audit Logs
      summary: Get audit logs
      description: Returns audit log IDs. Admins see all logs, users see logs related to them
      responses:
        '200':
          description: List of audit log IDs
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
                  format: uuid
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: No audit logs found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

  /api/auditlog/{id}:
    get:
      tags:
        - Audit Logs
      summary: Get audit log by ID
      description: Returns a specific audit log if the user has permission to view it
      parameters:
        - $ref: '#/components/parameters/AuditLogIdPath'
      responses:
        '200':
          description: Audit log details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuditLogDTO'
        '400':
          description: Invalid audit log ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          description: Audit log not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ControlledException'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token obtained from login or registration

  parameters:
    UserIdPath:
      name: id
      in: path
      required: true
      schema:
        type: string
        format: uuid
      description: User ID

    IssueIdPath:
      name: id
      in: path
      required: true
      schema:
        type: string
        format: uuid
      description: Issue ID

    CommentIdPath:
      name: id
      in: path
      required: true
      schema:
        type: string
        format: uuid
      description: Comment ID

    NotificationIdPath:
      name: id
      in: path
      required: true
      schema:
        type: string
        format: uuid
      description: Notification ID

    TagIdPath:
      name: id
      in: path
      required: true
      schema:
        type: string
        format: uuid
      description: Tag ID

    StatusIdPath:
      name: id
      in: path
      required: true
      schema:
        type: string
        format: uuid
      description: Status ID

    PriorityIdPath:
      name: id
      in: path
      required: true
      schema:
        type: string
        format: uuid
      description: Priority ID

    RoleIdPath:
      name: id
      in: path
      required: true
      schema:
        type: string
        format: uuid
      description: Role ID

    AuditLogIdPath:
      name: id
      in: path
      required: true
      schema:
        type: string
        format: uuid
      description: Audit Log ID

  responses:
    UnauthorizedError:
      description: Authentication required or insufficient permissions
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ControlledException'
          example:
            message: "You are not authorized to access this resource"
            errorCode: "UNAUTHORIZED"

  schemas:
    # Authentication DTOs
    LoginDTO:
      type: object
      required:
        - username
        - password
      properties:
        username:
          type: string
          description: Username for login
          example: "john_doe"
        password:
          type: string
          format: password
          description: User password
          example: "securePassword123"

    RegisterDTO:
      type: object
      required:
        - username
        - password
        - email
      properties:
        username:
          type: string
          description: Desired username
          example: "jane_doe"
        password:
          type: string
          format: password
          description: User password
          example: "securePassword123"
        email:
          type: string
          format: email
          description: User email address
          example: "jane@example.com"
        firstName:
          type: string
          description: User's first name
          example: "Jane"
        lastName:
          type: string
          description: User's last name
          example: "Doe"

    TokenResponse:
      type: object
      properties:
        username:
          type: string
          description: Username
          example: "john_doe"
        role:
          type: string
          description: User role
          example: "User"
        expiresAt:
          type: string
          format: date-time
          description: Token expiration time
        jwt:
          type: string
          description: JWT token
          example: "eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9..."
        userId:
          type: string
          format: uuid
          description: User ID

    # User DTOs
    UserDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: User ID
        username:
          type: string
          description: Username
          example: "john_doe"
        email:
          type: string
          format: email
          description: User email
          example: "john@example.com"
        firstname:
          type: string
          description: First name
          example: "John"
        lastname:
          type: string
          description: Last name
          example: "Doe"
        role:
          $ref: '#/components/schemas/RoleDTO'
        isSuspended:
          type: boolean
          description: Whether the user is suspended
        suspendedAt:
          type: string
          format: date-time
          description: When the user was suspended
          nullable: true
        createdAt:
          type: string
          format: date-time
          description: Account creation date
        issues:
          type: array
          items:
            type: string
            format: uuid
          description: List of issue IDs associated with the user

    UpdateUserDTO:
      type: object
      properties:
        username:
          type: string
          description: New username
        email:
          type: string
          format: email
          description: New email address
        firstname:
          type: string
          description: New first name
        lastname:
          type: string
          description: New last name
        password:
          type: string
          format: password
          description: New password

    SuspendUserDTO:
      type: object
      required:
        - isSuspended
      properties:
        isSuspended:
          type: boolean
          description: Whether to suspend or unsuspend the user

    # Issue DTOs
    IssueDTO:
      type: object
      required:
        - title
        - description
      properties:
        title:
          type: string
          description: Issue title
          example: "Login page not working"
        description:
          type: string
          description: Issue description
          example: "Users are unable to log in to the application"
        assignedToId:
          type: string
          format: uuid
          description: ID of the user assigned to this issue
          nullable: true
        statusId:
          type: string
          format: uuid
          description: Status ID
          nullable: true
        priorityId:
          type: string
          format: uuid
          description: Priority ID
          nullable: true

    IssueToFrontendDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Issue ID
        title:
          type: string
          description: Issue title
        description:
          type: string
          description: Issue description
        user:
          $ref: '#/components/schemas/UserDTO'
        assignedTo:
          $ref: '#/components/schemas/UserDTO'
          nullable: true
        status:
          $ref: '#/components/schemas/StatusDTO'
        priority:
          $ref: '#/components/schemas/PriorityDTO'
        tags:
          type: array
          items:
            $ref: '#/components/schemas/TagDTO'
        comments:
          type: array
          items:
            $ref: '#/components/schemas/CommentResponseDTO'
        createdAt:
          type: string
          format: date-time
          description: Issue creation date
        lastUpdated:
          type: string
          format: date-time
          description: Last update date
        isDeleted:
          type: boolean
          description: Whether the issue is deleted

    # Comment DTOs
    CommentDTO:
      type: object
      required:
        - issueId
        - content
      properties:
        issueId:
          type: string
          format: uuid
          description: ID of the issue this comment belongs to
        content:
          type: string
          description: Comment content
          example: "This issue has been resolved"
        parentCommentId:
          type: string
          format: uuid
          description: ID of the parent comment if this is a reply
          nullable: true

    CommentResponseDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Comment ID
        content:
          type: string
          description: Comment content
        user:
          $ref: '#/components/schemas/UserDTO'
        issueId:
          type: string
          format: uuid
          description: Issue ID
        parentComment:
          $ref: '#/components/schemas/CommentResponseDTO'
          nullable: true
        replies:
          type: array
          items:
            $ref: '#/components/schemas/CommentResponseDTO'
        createdAt:
          type: string
          format: date-time
          description: Comment creation date
        isDeleted:
          type: boolean
          description: Whether the comment is deleted

    # Notification DTOs
    NotificationDTO:
      type: object
      required:
        - isRead
      properties:
        isRead:
          type: boolean
          description: Whether the notification has been read

    NotificationResponseDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Notification ID
        message:
          type: string
          description: Notification message
        user:
          $ref: '#/components/schemas/UserDTO'
        isRead:
          type: boolean
          description: Whether the notification has been read
        readAt:
          type: string
          format: date-time
          description: When the notification was read
          nullable: true
        createdAt:
          type: string
          format: date-time
          description: Notification creation date

    # Reference DTOs
    TagDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Tag ID
        name:
          type: string
          description: Tag name
          example: "bug"
        description:
          type: string
          description: Tag description
          example: "Issues related to bugs"

    StatusDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Status ID
        name:
          type: string
          description: Status name
          example: "Open"
        description:
          type: string
          description: Status description
          example: "Issue is open and needs attention"

    PriorityDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Priority ID
        name:
          type: string
          description: Priority name
          example: "High"
        level:
          type: integer
          description: Priority level (numeric representation)
          example: 3

    RoleDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Role ID
        name:
          type: string
          description: Role name
          example: "Administrator"
        isAdmin:
          type: boolean
          description: Whether this role has admin privileges
        isSupport:
          type: boolean
          description: Whether this role has support privileges
        isDefault:
          type: boolean
          description: Whether this is the default role for new users

    # Audit Log DTO
    AuditLogDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Audit log ID
        user:
          $ref: '#/components/schemas/UserDTO'
          nullable: true
        issue:
          $ref: '#/components/schemas/IssueToFrontendDTO'
          nullable: true
        action:
          type: string
          description: Action performed
          example: "User Login"
        details:
          type: string
          description: Detailed description of the action
        ipAddress:
          type: string
          description: IP address of the user
          example: "192.168.1.1"
        userAgent:
          type: string
          description: User agent string
        suspiciousScore:
          type: integer
          description: Suspicious activity score (0-5)
          minimum: 0
          maximum: 5
        isSystemAction:
          type: boolean
          description: Whether this was a system-generated action
        createdAt:
          type: string
          format: date-time
          description: When the action was logged

    # Error DTO
    ControlledException:
      type: object
      properties:
        message:
          type: string
          description: Error message
          example: "Resource not found"
        errorCode:
          type: string
          description: Error code for programmatic handling
          example: "USER_NOT_FOUND"
      required:
        - message
        - errorCode

tags:
  - name: Authentication
    description: User authentication and registration
  - name: Users
    description: User management operations
  - name: Issues
    description: Issue tracking and management
  - name: Comments
    description: Comment management for issues
  - name: Notifications
    description: User notification management
  - name: Tags
    description: Tag management for categorizing issues
  - name: Status
    description: Issue status management
  - name: Priorities
    description: Issue priority management
  - name: Roles
    description: User role management
  - name: Audit Logs
    description: System audit trail and logging
